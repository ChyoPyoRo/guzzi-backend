CREATE TABLE USERS (
 USER_ID        INT NOT NULL PRIMARY KEY,
 ID            VARCHAR(20) NOT NULL,
 PASSWORD      VARCHAR(200) NOT NULL,
 CREATE_AT     DATE NOT NULL
)


INSERT INTO USERS VALUES ('HJN4030','1111',CURRENT_TIMESTAMP,'1')


 #  UPDATED_AT DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP

CREATE TABLE TOKEN (
 USER_ID              INT NOT NULL ,
 TOKEN_ID             INT NOT NULL PRIMARY KEY,
 REFRESH_TOKEN        VARCHAR(500) NOT NULL,
 CREATED_AT  des         DATE NOT NULL
);



---

CREATE TABLE VOTE (
 USER_ID          INT NOT NULL ,
 VOTE_ID          INT NOT NULL PRIMARY KEY,
 CONTENT         VARCHAR(600) NOT NULL,
 FIRST_ANSWER     VARCHAR(100) NOT NULL,
 SECOND_ANSWER    VARCHAR(100) NOT NULL,
 CREATE_AT DATE  NOT NULL);



CREATE TABLE VOTE_ANSWER (
 VOTE_ID         INT NOT NULL,
 VOTE_ANSWER_ID        INT NOT NULL PRIMARY KEY,
 FIRST_ANSWER_COUNT     INT DEFAULT 0 NOT NULL ,
 SECOND_ANSWER_COUNT    INT DEFAULT 0 NOT NULL
 )


CREATE TABLE MY_VOTE_ANSWER (
MY_VOTE_ID INT NOT NULL PRIMARY KEY,
VOTE_ID INT NOT NULL,
USER_ID INT NOT NULL,
FIRST_RATIO INT NOT NULL,
SECOND_RATIO INT NOT NULL,
CHK VARCHAR(20) NOT NULL
)

 CREATE TABLE VOTE_ANSWER(
 VOTE_ID INT NOT NULL,
 VOTE_ANSWER_ID INT NOT NULL PRIMARY KEY,
 FIRST_ANSWER_COUNT INT DEFAULT 0 NOT NULL,
 SECOND_ANSWER_COUNT INT DEFAULT 0 NOT NULL,
 FIRST_ANSWER_RATIO NUMBER DEFAULT 0 NOT NULL,
 SECOND_ANSWER_RATIO NUMBER DEFAULT 0 NOT NULL);

CREATE TABLE MY_VOTE_ANSWER (
MY_VOTE_ID INT NOT NULL PRIMARY KEY,
VOTE_ID INT NOT NULL,
USER_ID INT NOT NULL,
MY_answer int NOT NULL
)
-- int로 해서 1,2로 저장


DELETE FROM VOTE;
INSERT INTO VOTE VALUES ('1','1','컨텐츠','1번대답','2번대답',CURRENT_TIMESTAMP,'');

-- NLS 설정 확인 명령어 (NLS_SESSION_PARAMETERS 뷰에서 확인)
SELECT * FROM NLS_SESSION_PARAMETERS;

-- 명령어로 변경하기(SESSION 설정 변경)
-- 'NLS_DATE_FORMAT =' 다음에 원하는 DATE_FORMAT을 넣어주면 됩니다.
ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS';






CREATE TABLE SUPPLIER
(
  SUPPLIER_ID NUMERIC(10) NOT NULL,
  SUPPLIER_NAME VARCHAR2(50) NOT NULL,
  CONTACT_NAME VARCHAR2(50),
  CONSTRAINT SUPPLIER_PK PRIMARY KEY (SUPPLIER_ID)
);

-- SEQUENCE 생성
CREATE SEQUENCE USER_SEQ
  INCREMENT BY 1
  START WITH 0
  MAXVALUE 999999
  MINVALUE 0
  NOCYCLE
  CACHE 20;

CREATE SEQUENCE VOTE_SEQ
  INCREMENT BY 1
  START WITH 0
  MAXVALUE 999999
  MINVALUE 0
  NOCYCLE
  CACHE 20;

CREATE SEQUENCE MY_VOTE_ANSWER_SEQ
  INCREMENT BY 1
  START WITH 0
  MAXVALUE 999999
  MINVALUE 0
  NOCYCLE
  CACHE 20;

CREATE SEQUENCE VOTE_ANSWER_SEQ
  INCREMENT BY 1
  START WITH 0
  MAXVALUE 999999
  MINVALUE 0
  NOCYCLE
  CACHE 20;



















  ----
          INSERT INTO vote
          ( USER_ID, VOTE_ID, CONTENT, FIRST_ANSWER, SECOND_ANSWER, CREATE_AT, UPDATE_AT )
          VALUES
          (  '1', vote_Seq.NEXTVAL ,'컨탠츠','컨1','컨2', sysdate, '')
---

 INSERT INTO vote ( USER_ID, VOTE_ID, CONTENT, FIRST_ANSWER, SECOND_ANSWER, CREATE_AT, UPDATE_AT ) VALUES (  '1', voteSeq.NEXTVAL ,'컨탠츠','컨1','컨2', sysdate, '')
  ---
          INSERT INTO vote_answer
          (  VOTE_ID, VOTE_ANSWER_ID, FIRST_ANSWER_COUNT, SECOND_ANSWER_COUNT, FIRST_RATIO, SECOND_RATIO )
          VALUES
          ( 2, VOTE_ANSWER_SEQ.NEXTVAL , 1, 4, 25, 75)
  ---
          insert into my_vote_answer (MY_VOTE_ID, VOTE_ID, USER_ID, CHK)
          values (MY_VOTE_ANSWER_SEQ.NEXTVAL, 0, 1, 'none');
          (ratio는 임의의 비율)


          ----

SELECT A.vote_id, B.FIRST_ANSWER_COUNT FROM VOTE A LEFT JOIN VOTE_ANSWER B ON A.VOTE_ID = B.VOTE_ID WHERE A.VOTE_ID = 0;

--> oracle 에서 실행이 되는데 mybatis에서 실행ㅇ하면 조인이 진행되지 않는다.











ALTER TABLE VOTE_ANSWER ADD FIRST_RATIO Int NOT NULL;
ALTER TABLE VOTE_ANSWER ADD SECOND_RATIO Int NOT NULL;
<!--        update MY_VOTE_ANSWER set FIRST_RATIO = 70, SECOND_RATIO = 30 WHERE VOTE_ID = 0-->




ALTER TABLE USERS DROP COLUMN USERID;
ALTER TABLE USERS ADD USERID LONG NOT NULL; -- PRIMARY KEY 는  LONG TYPE 을 사용하지 못한다.
ALTER TABLE USERS MODIFY USERID INT; --TYPE 변경
ALTER TABLE USERS MODIFY (PASSWORD NOT NULL) -- 포맷 변경
ALTER TABLE USERS ADD CONSTRAINT USER_PK PRIMARY KEY (USERID);--(기존컬럼,추가컬럼)
DESC USERS; -- 테이블 구조 확인 명령어
ALTER TABLE my_vote_answer DROP COLUMN FIRST_RATIO; -- 컬럼 삭제 명령어
ALTER TABLE my_vote_answer DROP COLUMN SECOND_RATIO; -- 컬럼 삭제 명령어

--ALTER TABLE VOTE ADD UPDATE_AT TIMESTAMP;
ALTER TABLE VOTE MODIFY CREATE_AT DATE; --TYPE 변경
ALTER TABLE VOTE MODIFY UPDATE_AT DATE; --TYPE 변경